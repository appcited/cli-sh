#!/bin/sh
set -eu

#            /$$ /$$                   /$$
#           | $$|__/                  | $$
#   /$$$$$$$| $$ /$$          /$$$$$$$| $$$$$$$
#  /$$_____/| $$| $$ /$$$$$$ /$$_____/| $$__  $$
# | $$      | $$| $$|______/|  $$$$$$ | $$  \ $$
# | $$      | $$| $$         \____  $$| $$  | $$
# |  $$$$$$$| $$| $$         /$$$$$$$/| $$  | $$
#  \_______/|__/|__/        |_______/ |__/  |__/
#
#  A minimal, customizable CLI written in shell
#              cli-sh.dev | v0.3.2

if [ -z "${1:-}" ]; then
    echo "`sed -n '3,14p' ${0}`\n"

    find run/* | sort | awk -F/ '
    {
        for (i=2; i<NF; i++) 
            printf("%4s", "|-- ")
        print $NF
    }
    '

    exit 2
fi

if [ -f "./run/hooks/before" ]; then
    . ./run/hooks/before
fi

if [ -d ${1} ]; then
    "${1}/$(basename ${1})"
else
    ${1}
fi

if [ -f "./run/hooks/after" ]; then
    . ./run/hooks/after
fi
